# Pass Companion (Native)
A lightweight companion script for the the [Pass Companion](../) browser extension. 

A native program is required because the monolithic Chromium operating system does not allow for programmatic interactions with the filesystem, when the Chromium virtual machine adds the ability to do that I will port gpg to native javascript personally.

## Building
You don't really need to build this for Chromium to be able to run it, if you really want to I'd suggest using `nexe`.

## Oh g̻͙͖̽̓ͪ͐͢oͧ͛̊͗̇d͕̹̖̃̿̃ͯ͛͂ w̝̹̰ͮ́̅ͩ̏ͪh̸͒͊a̪͈ͯͫͨͧ̑͗́t̐͏̣̙̤̫ t̵̢͔̜͈̜͑̄̂̆̿ͪh̖̰̞̱͒̇ͯ̃͐̉ͦ̚͠ͅe͎͚̝̮ͭ̾̓͛͘̕͟ fͨ̂͆̔̐͂̋͋̑͂͏̷̷̮̘͎̮͍͔̼͠͝u͌̽ͩ̅̾͌̋̾̑̔̓͗̈̽̆҉̼̹̭̯̘̻̺̘͓̜̀c̃̏͌͌̄͏̶̤͍̤̞k̸͔̙̙̳̙̼̜͖̤̝̭̰̥̭̾̌͆ͭ̃͛̓ͣͮ̏͂̽̈͋ͦ͆͐̕͢͝ i̷̙̼̮̺̰͕̠̹̲͉̽̉͆ͩ̽̍̌̌͠s̩̳͇̻̪̥͍̊̃ͫͮ̽̓͐ͯͤͣ̐̕͡ ͧͮ̒ͩͮͪ͗ͮ̓̔̉̉͏̡҉̹͈̠̫̫͜t̪̝̺̿̈́̆̒ͥ͊̒͑̎ͪ̆͠͠ĥ̶̡̘͍̪͔́̇̾̄͛̃ͩ̌͗̂̎̂͆̔̾ͦ͟͝e̶̵̴̦̼̼̭͈̯̻͎̩̠̙͉̩̋ͮ̓̒̔ͭ̌̔͗̔ ̵̧̛̘̪̝̜̦̞͙̞̜͎̰̹̭̣̭̇͆ͪ̂ͥ̀͑̒ͭ̽ͤ̓́ͅn̸̡͇͇̙̱͔͎̜̥ͪ̃͒ͦ͗͌͜á̡̬̮̖͈̤̼̟̼͓̣͍̤̰̮̣̟ͩ̏͋̐̊͑̇ͧ̍̄ͥ̀̚͞t̸͉̰̼̺̹̬̭͖͎̗͔̟̺͔͇̗̱̋̔̌̄̊̂̊̑ͥ́ͣͭͪ̀̓̋̑̆̊̕͝͡ͅͅi̸͇̱̺̖̹̞̹̹̬̯̯̠̩͇̰̩͖̒̒ͪ̏̉̃͞ͅv̹͎̯͈͎̖̄̈́̾̈́̂ͤ̒́̏͒̈ͦ̏̓͠͡ę̝̟̰̺̳̖̭̰͈̘̳̱͕͍̲̂̅̑̔̑ͥͥ̍͌̐ͣ̄̀͋͢͝ ̴̧̛̰̝͇ͨ͊̓̇̽́̋ͩ̂̒͆͑͐ͧͭ͢͜c̷̺̠̥͚͙̦ͨ̾͋͛ͣ̉̓̕o̶̧͔̘̣͈̻̟̠͇̬̪̯̣̞͕̹ͩ̌̐̅͒̐̔̽̔ͭ̇ͅm̵̸̢̹̗̯̯̹̩͙̻͎̺͍̔ͥ̊ͥ͛̾ͨͫ́͠m̶̢͖͈̩̦̹͆́ͯ̇̓ͩ̂̅̏̿͢u̪͙̫̬͇͈̘͔͈̯͓͎̞͈̭ͧ̈͋̏̑͗͂ͮͥͨͭͦ͠ͅṅ̡̧̇ͧ̿̽ͯ̿͑͑̈ͯ͗̓̂ͦ͏͚̥̠͓͚̪͇̪͕̣̻î̴̩̲̞͎̠̰̝̠̼̹̰̤͈̘͓͙̭̊ͬ̈̇̃́͢͟ͅc̵͕̝̬͕̙̙̳̫̲̤̊͑͐ͩ̑ͩͩͫͩͥ̅ͥ͗ͧͯͩ́͢ͅȁ̵̡͉̣̭͈͇͍̗̮̗̩̭̗͙̯̥͉̮͚̍̅̐̏ͦͬ̂̌̍͟t̡͇̯͍̻̜̙̭̅͊̍ͭ͒ͫͮ͐ͯ͌͑̒̑ͭ́ǐ̧͓͈͍̬̰͈̰̬̱̹͉͒̒͊ͬ̍̈ͬ͗ͥ͆ͧ̇̿̇ͭ̿ͭ͘o̡̧̳̝͓̠̱̝̬̮̦̙̝ͨͤ̓ͪͬ͆̆̇̊ͫ̌ͯ͂͆̎̆ͧͪͭ̀̕͘n̙̟͍̲̣̩̗̲̫̻̺̬̽ͭ͊ͩͦͫͧ͟͢͝ ̸̥̞͇̣̩͓̖̖͖̼̄̌͛͊͊̓̒̈͆͐̕͘̕p̨̣̭͈̜̠̮̱̩̯͉̍̋̔̇ͨ͒ͮ̓͌ͨͤͨ̕͟r̸͉͇̠̭͙̞̯̲̟̰̰̍͗ͣ̅̍̎̓̾͊͊̎͗̕ͅõ̸͖̼̜̰͍̫̞̘̖̭̫͖̬ͥ̎̈́̏͌ͥͩͥ͗̿͛ͯ̿̅̉͠͞t̀͊ͭ̑͋̏͌ͥ̐̈͛̃͑̚̚͏̧̛̞̙̦̤̰́ǫ̷̔͐̏ͣ̄ͧ̄҉̷͓̫͇͚͍̫̫̤̮ͅç̮̝̗̥̳̠͕̍ͥ̍̀̿̃͆ͮ̑͛̋͂ͬ̈́̇̋́o̡̱̟̲͚̫̺̘̘̞͎̺̲͋͊ͩ͐͌ͬ̊ͬ͌ͭ͑̀̀͘͜ͅl̶̟͇͉̖̙̃̌ͪ͂ͤ͗̆ͧ͒ͩͭͬ̓̏͘͠?̰̮̭͖̦̞̠̭͕̪̹̼̮̻̜̙͚̙̽̋̄͛̂ͮ̆̈̃͘͟͢ ̊̾ͦ̀̓̾͂͏̨̞̳̫̩͉̭͙͓͙̞̘͔W̸̴̮̪̗̻̩̞̲̪̦̘̻̲̻̣͛ͩ̃̊̽̎͑͂ͪ͗̇͂ͤ͑̔̍ͬͣ́̕Ḥ̸̸̵̤͍̱̯̉͑́̕y̶̛̜̩͙̤̭͎͕̖͖̥ͫ̿͌ͬ̆ͫ́ͭ̾ͫ͆ͥ͐͒ ̶̸̮̜̙̳̤͓̙̪̬̻͕̭͑̈͌͗͐̄ͯį̵̸̱̣͔̘̩̠̫ͫ̀̃ͯ͌̓ͧ̽̉͂̈́͘S̵̡̥͇̥͍̮̺̩͚̖̜̟ͨ̂̋̒ͭ̉̏͛̔͐͜͡͡ ̨̠̯͇̫͕̼̯̘̅͌ͬ̍ͩH̱̠̥̱͈̞͉̮̝̙̱̯͙̱ͧ̉͐͌͒ͨ̉̾̈̄͆ͤ̍́͜͞ͅͅͅỆ͙̱͉͎̹̝̟̺̜̝̯̬̰̳͚̺̤͖͛ͭ̅ͧ͋̏̾̓ͯ́́́̚͘͡ ̴͎̼̫̰̹̞̩̬͔̜̜̟ͭͫ͌ͣͬ̉̃ͮ̍ͤͣ͆͒̂͊ͯ̐̃ͦC̴̡̛̦̜̲̟̺̥̰̗̭̺̰͑̈̏ͪͬ͆̊̈ơ̬͕̻̖͖̳̬̐ͨ͒͗ͯ̓̒̂͒ͣ̑̎ͯ͗͛̉̇͢ͅM̴̸̫͚͖̫̺̅̍̀̔̑ͯ͋ͪ̉ͩ͒̿͢͢͠Į̷̘̦̯̱̻̠ͦ̎ͤ́̉ͣ̿̉ͮ̕ͅn̵͍͇̝̱̬̂̑ͭͥ͋̽ͯͤͪ̎̐̑͋̐͌̎͢͞g͐̎͑̓̔͐̃̎ͣ͂̚͏̡̩͕̤̫̞̥͕͉̩̤͙̙̮̞̙̗͈͘͡ͅ?̴̡̎́̅̈́̇ͬ̅͑̾̊̅̓͗̉̓̍̊͆̓͏͕̘̤̘̻̩̪̫̤̹̘
Since chromium does not explain at all how native communication works, I'll quickly write some stuff here in case anyone has the displeasure of having to use it.

When chromium summons the process, commands are sent with the following format via Standard Input (stdin).

> `[4-byte UInt32LE serialized json length][json]`

In the native companion the scripts that handle this are in [utils.js](lib/utils.js). Want to use it yourself? Feel free, this took several days because I'm very lazy

## Commands
If you wish to use the native companion in your own stuff, you can! Here are the commands it accepts

Command|Purpose|Requires|Returns
----|----|----|----
`readdir`|Returns an array of gpg files in the store directory|`{ 'command': 'readdir' }`|`[ 'm.com', 'example.com/admin', 'example.com/user' ]`
`readusername`|Returns a String of the username if available.|`{ 'command': 'readusername', 'query': 'example.com/user' }`|`{ 'username': String }`
`readpassword`|Returns a String of the password.|`{ 'command': 'readpassword', 'query': 'example.com/user' }`|`{ 'password': String }`
`readotp`|Calls `pass otp` to return a totp code.|`{ 'command': 'readotp', 'query': 'example.com/user' }`|`{ 'otp': '123456' }`
